# This file should be inclued in the /etc/ids.cfg, in my opinion
# Please also note that /etc/init.d/bridge may need to be changed
# It works with suricata-ips-nfqueue and /etc/init.d/bridge

# Get total number of core of the CPU
CORE=`grep -c ^processor /proc/cpuinfo`

# for the Suricata queue and iptables use
QUEUE=$((CORE-1))

# for the Suricata command and use
PARAMETER=""

# Get the queue for the Suricata in inline mode
for i in `seq 0 1 $QUEUE`
do 
	PARAMETER+="-q$i "
done

